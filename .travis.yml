language: java
sudo: false
install: true
addons:
  sonarcloud:
    organization: "russo595-github"
    token:
      secure: "0b5aedcf035f8d0c30c605b32676025bb7ae6089"
jdk:
  - oraclejdk8
branches:
  only:
  - master

before_script:
 - echo "Starting build"

script:
 - mvn clean org.jacoco:jacoco-maven-plugin:prepare-agent package sonar:sonar
cache:
  directories:
    - '$HOME/.m2/repository'
    - '$HOME/.sonar/cache'
after_script:
 - echo "Script finished"

after_success:
 - echo "Build was successful. $TRAVIS_TEST_RESULT"
 - ls -l $TRAVIS_BUILD_DIR/target

after_failure:
 - echo "Build was failed"

notifications:
  email:
    on_success: change
    on_failure: always